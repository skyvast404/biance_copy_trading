# 更新日志

## [1.0.0] - 2024-11-02

### 🎉 初始版本

#### ✨ 新功能
- 实时监控主账户交易并自动跟单
- 支持多个跟随账户，每个账户可设置不同比例
- WebSocket 自动重连机制
- 灵活的 YAML 配置文件
- 详细的日志记录和统计信息
- 交易对白名单/黑名单过滤

#### 🔧 核心改进（相比原始版本）

##### 关键 Bug 修复
1. **修复数据解析错误** - 正确解析 executionReport 数据结构
2. **修复数量字段错误** - 使用 `l`(last executed qty) 而非 `q`(order qty)
3. **修复类型错误** - timestamp 参数类型修正
4. **修复 MARKET 订单处理** - 跟单账户统一使用 MARKET 订单

##### 重要功能增强
1. **时间同步机制** - 自动同步本地时间与服务器时间
2. **recvWindow 支持** - 处理网络延迟，避免签名失败
3. **数量精度处理** - 根据 LOT_SIZE 规则自动调整数量精度
4. **订单去重** - 防止 WebSocket 重复消息导致重复下单
5. **部分成交支持** - 正确处理 PARTIALLY_FILLED 状态
6. **限频保护** - 避免超过 API 限频被封禁
7. **错误重试** - 网络错误自动重试（指数退避）
8. **符号过滤器缓存** - 减少 API 调用次数
9. **WebSocket ping/pong** - 连接健康检查
10. **详细错误分类** - 区分余额不足、MIN_NOTIONAL 等错误

#### 📦 项目结构
```
copy_trade/
├── main.py                    # 主程序入口
├── config.example.yaml        # 配置模板
├── requirements.txt           # 依赖文件
├── README.md                  # 英文文档
├── README_CN.md               # 中文使用指南
├── CODE_REVIEW.md             # 代码审查报告
├── CHANGELOG.md               # 更新日志
└── src/                       # 核心模块
    ├── config_loader.py       # 配置加载
    ├── binance_client.py      # API 客户端
    ├── copy_trade_engine.py   # 跟单引擎
    └── logger.py              # 日志系统
```

#### 🔐 安全特性
- API Key 权限检查
- IP 白名单建议
- 配置文件 .gitignore 保护
- 测试网优先原则

#### 📊 统计功能
- 运行时长
- 总交易次数
- 成功/失败次数
- 去重过滤次数
- 成功率计算

#### 📝 文档
- 完整的中英文文档
- 快速开始指南
- 常见问题解答
- 配置说明
- 代码审查报告

---

## 已知问题

### 待实现功能
- [ ] 下单前余额检查
- [ ] MIN_NOTIONAL 过滤器检查
- [ ] 价格精度处理（类似数量精度）
- [ ] 并发下单优化
- [ ] 交易记录持久化
- [ ] Web 管理界面
- [ ] 告警通知系统

### 限制
- 仅支持现货交易（不支持期货）
- 仅支持币安交易所
- 跟单账户统一使用 MARKET 订单

---

## 升级指南

### 从原始版本升级

1. **备份旧配置**
   ```bash
   # 如果有旧的配置，先备份
   cp config.yaml config.yaml.bak
   ```

2. **安装新依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **创建新配置**
   ```bash
   cp config.example.yaml config.yaml
   # 编辑 config.yaml，填入 API 密钥
   ```

4. **测试运行**
   ```bash
   # 先在测试网测试
   python main.py
   ```

---

## 技术债务

### 代码质量
- ✅ 模块化设计
- ✅ 类型注解
- ✅ 文档字符串
- ✅ 错误处理
- ⚠️ 单元测试（待添加）

### 性能
- ✅ 连接池复用
- ✅ 符号过滤器缓存
- ✅ 限频保护
- ⚠️ 并发下单（待优化）

### 可靠性
- ✅ 自动重连
- ✅ 错误重试
- ✅ 订单去重
- ⚠️ 数据持久化（待添加）

---

## 贡献者

- 初始开发：AI Assistant
- 代码审查：基于币安官方文档和量化交易最佳实践

---

## 许可证

MIT License

---

## 支持

如有问题或建议，请提交 Issue。

**⚠️ 免责声明**: 本软件仅供学习研究使用，使用本软件进行交易的所有风险由使用者自行承担。
